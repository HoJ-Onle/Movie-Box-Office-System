<!DOCTYPE HTML>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title>MovieLook--票房数据直方图</title>

    <!--Tab页图标-->
    <link rel="shortcut icon" type="image/x-icon" href="images/logo/logosmall.png" />

    <!--插入样式表-->
    <link rel="stylesheet" type="text/css" href="style/css/style.css" media="all" />
    <link href='http://fonts.googleapis.com/css?family=Amaranth' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Droid+Serif:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
    <!--[if IE 7]-->
    <!--<link rel="stylesheet" type="text/css" href="style/css/ie7.css" media="all" />-->
    <!--[endif]-->
    <!--[if IE 8]-->
    <!--<link rel="stylesheet" type="text/css" href="style/css/ie8.css" media="all" />-->
    <!--[endif]-->
    <!--[if IE 9]-->
    <!--<link rel="stylesheet" type="text/css" href="style/css/ie9.css" media="all" />-->
    <!--[endif]-->

    <!--插入jquery.js脚本-->
    <script type="text/javascript" src="style/js/jquery-1.6.4.min.js"></script>
    <!--设置多级导航菜单的插件-->
    <script type="text/javascript" src="style/js/ddsmoothmenu.js"></script>
    <!--设置图片大图展示的插件-->
    <script type="text/javascript" src="style/js/jquery.prettyPhoto.js"></script>
    <!--生成可视化图表的插件-->
    <script type="text/javascript" src="style/js/echarts.min.js"></script>
    <script type="text/javascript" src="style/js/paint_charts.js"></script>
    <!--设置圆角边框的脚本-->
    <script type="text/javascript" src="style/js/jquery.corner.js"></script>
    <!--这个是自己写的js脚本-->
    <script type="text/javascript" src="style/js/carousel.js"></script>
    <!--设置滚动传送的插件-->
    <script type="text/javascript" src="style/js/jquery.jcarousel.js"></script>
    <!--其他用途的插件-->
    <script type="text/javascript" src="style/js/jquery.flexslider-min.js"></script>
    <script type="text/javascript" src="style/js/jquery.masonry.min.js"></script>
    <script type="text/javascript" src="style/js/jquery.slickforms.js"></script>
    <!--scripts.js负责侧栏的时间监控-->
    <script type="text/javascript" src="style/js/scripts.js"></script>
    <script type="text/javascript" src="style/js/func_save_click.js"></script>
    <!--顶层菜单栏部分-->
    <link rel="stylesheet" type="text/css" href="style/css/ddsmoothmenu.css" />
    <script type="text/javascript">
        ddsmoothmenu.init({
            mainmenuid: "smoothmenu1",
            orientation: 'h',
            classname: 'ddsmoothmenu',
            contentsource: ['smoothmenu1','sidebar_user.html']	,
            //customtheme: ["#1c5a80", "#18374a"]
        })
    </script>
</head>
<body>

<script type="text/javascript">
    window.alert = function (txt, time) {
        if (document.getElementById("alertFram")) {
            return;
        }
        var alertDiv = document.createElement("DIV");
        alertDiv.id = "alertFram";
        alertDiv.style.position = "absolute";
        alertDiv.style.left = "50%";
        alertDiv.style.top = "40%";
        alertDiv.style.marginLeft = "-225px";
        alertDiv.style.marginTop = "-75px";
        alertDiv.style.width = "450px";
        alertDiv.style.height = "150px";
        alertDiv.style.background = "#ccc";
        alertDiv.style.textAlign = "center";
        alertDiv.style.lineHeight = "150px";
        alertDiv.style.zIndex = "10000";
        alertDiv.innerHTML = "<ul style='list-style:none;margin:0px;padding:0px;width:100%'><li style='background:#DD828D;text-align:left;padding-left:10px;font-size:14px;font-weight:bold;height:27px;line-height:25px;border:1px solid #F9CADE;'>MovieLook提示</li><li style='background:#fff;text-align:center;font-size:17px;height:120px;line-height:120px;border-left:1px solid #F9CADE;border-right:1px solid #F9CADE;'>" + txt + "</li><li style='background:#FDEEF4;text-align:center;font-weight:bold;height:27px;line-height:25px; border:1px solid #F9CADE;'onclick='doOk()'><input type='button' style='background-color: #FDEEF4;border: none;outline:none;' value='确 定'/></li></ul>";
        //                                                                                                                                                                  提示框高度 ;提示文本高度位置;                                                                                          文本字体大小  ;                               左边框颜色                   ;右边框颜色                    ;
        document.body.appendChild(alertDiv);
        var c = 0;
        this.timer = function () {
            if (c++ > time) {
                clearInterval(ad);
                document.body.removeChild(alertDiv);
            }
        }
        var ad = setInterval("timer()", 1000);
        this.doOk = function () {
            document.body.removeChild(alertDiv);
        }
        alertDiv.focus();
        document.body.onselectstart = function () {
            return false;
        };
    }
    function get_cookie(cookieName){
        //判断cookie是否存在
        if (document.cookie.length>0){
            pos=document.cookie.indexOf(cookieName + "=")
            if (pos!=-1){
                pos=pos + cookieName.length+1
                last=document.cookie.indexOf(";",pos)
                if (last==-1) last=document.cookie.length
                return unescape(document.cookie.substring(pos,last))
            }
        }
        return 0;
    }
    var param = get_cookie('name');
    function checklogin(){
        if(get_cookie('name')==0){
            alert("请先登录使用完整功能",2);
            setTimeout(function(){
                window.location.href='index.html';
            },1000);
        }
        else{
            return true;
        }
    }
    checklogin();
</script>

<!-- Begin Wrapper -->
<div id="wrapper">
    <!--menu start-->
    <a class="animateddrawer" id="ddsmoothmenu-mobiletoggle" href="#">
        <span></span>
    </a>
    <div id="smoothmenu1" class="ddsmoothmenu">
    </div>
    <!--menu end-->

    <!--<div id="logo"><a href="index.html"><img src="images/other/logo.png" alt="电影数据可视化系统" /></a></div>-->

    <!--&lt;!&ndash; Begin Menu &ndash;&gt;-->
    <!--<div id="menu">-->
    <!--<noscript>-->
    <!--<a href="http://www.baidu.com">Site map(link to site map for search engines and user with JS disabled)</a>-->
    <!--</noscript>-->
    <!--</div>-->
    <!--&lt;!&ndash; End Menu &ndash;&gt;-->

    <!--<div class="sidebox">-->
    <!--<ul class="share">-->
    <!--<li><a href="#"><img src="images/other/icon-rss.png" alt="RSS" /></a></li>-->
    <!--<li><a href="#"><img src="images/other/icon-facebook.png" alt="Facebook" /></a></li>-->
    <!--<li><a href="#"><img src="images/other/icon-twitter.png" alt="Twitter" /></a></li>-->
    <!--<li><a href="#"><img src="images/other/icon-dribbble.png" alt="Dribbble" /></a></li>-->
    <!--<li><a href="#"><img src="images/other/icon-linkedin.png" alt="LinkedIn" /></a></li>-->
    <!--</ul>-->
    <!--</div>-->
    <!--</div>-->
    <!-- End Sidebar -->

    <!-- Begin Content -->
    <div id="content">
        <h1 class="title">票房数据直方图</h1>
        <div class="line"></div>
        <div class="intro">能够以直方图的形式动态展示每年/每季度/每月不同题材的票房数据</div>

        <div class="line"></div>
        <!-- Begin Post -->
        <div class="post">
            <!--<form action="#" method="get">-->
            <!--<input name="func_id" value="1" hidden>-->
            <div class="form_first">
                <p>选择年份</p>
                <select name="year">
                    <option value="2015">2015</option>
                    <option value="2016">2016</option>
                    <option value="2017">2017</option>
                    <option value="2018" selected="selected">2018</option>
                </select>
            </div>
            <div class="form_second">
                <p>选择季度</p>
                <select name="season">
                    <option value=0 selected="selected">--</option>
                    <option value="第一季">第一季</option>
                    <option value="第二季">第二季</option>
                    <option value="第三季">第三季</option>
                    <option value="第四季">第四季</option>
                </select>
            </div>
            <div class="form_third">
                <p>选择月份</p>
                <select name="month">
                    <option value=0 selected="selected">--</option>
                    <option value="01">01</option>
                    <option value="02">02</option>
                    <option value="03">03</option>
                    <option value="04">04</option>
                    <option value="05">05</option>
                    <option value="06">06</option>
                    <option value="07">07</option>
                    <option value="08">08</option>
                    <option value="09">09</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                </select>
            </div>
            <div class="form_forth form_submit">
                <!--<input type="submit" value="Submit" id="submit"/>-->
                <button id="submit" class='mybutton'>Submit</button>
            </div>
            <!--</form>-->
        </div>
        <div class="charts_div">
            <div class="charts" id="chart">
                <img src="./images/visualization_sample_big/slide1.jpg" style="height: 100%" alt="" />
            </div>
            <div class="clear"></div>
        </div>
        <!-- End Post -->
        <div style="position: relative;">
            <button  style="position: absolute; right: 30px;bottom:50px;" class="mybutton" id="save">Save</button>
        </div>

        <!-- Begin Footer -->
        <div id="footer">

            <div class="footer-box one-third">
                <h3>Big Events</h3>
                <ul class="popular-posts">
                    <li>
                        <a href="#"><img src="images/not_usefull/y1.jpg" alt="" /></a>
                        <h5><a href="#">Establishment</a></h5>
                        <span>26 Sept 2018 | <a href="#">The beginning...</a></span>
                    </li>

                    <li>
                        <a href="#"><img src="images/not_usefull/y3.jpg" alt="" /></a>
                        <h5><a href="#">Dolor Commodo Consectetur</a></h5>
                        <span>18 Dec 2018 | <a href="#">FirstDemo~</a></span>
                    </li>

                    <li>
                        <a href="#"><img src="images/not_usefull/y2.jpg" alt="" /></a>
                        <h5><a href="#">Dolor Commodo Consectetur</a></h5>
                        <span>25 Dec 2018 | <a href="#">Merry Christmas!</a></span>
                    </li>

                </ul>
            </div>

            <div class="footer-box one-third">
                <h3>About</h3>
                <p>Harbin Insitute of Technology (Shenzhen)<br>Department of Computer and Science.</p>
                <p>2018 Fall Course|Software Engineering|Group 13
                    <br>
                    <br>
                    <span class="lite1">Addr:</span> Shenzhen University Town<br>
                    <span class="lite1">Tel:</span> + 86 136 130 22604<br>
                    <span class="lite1">E-mail:</span> name@domain.com</p>


            </div>

            <div class="footer-box one-third last">
                <h3>MovieLook and U</h3>
                <p> 'From that moment on, that became my spot. I could sit there for hours, just looking out at the world. Some days the sunsets would be purple and pink, and some days they were a blazing orange, setting fire to the clouds on the horizon. <br><br>It was during one of those sunsets that my father's idea of the whole being greater than the sum of its parts moved from my head to my heart.'</p>
            </div>
        </div>
        <!-- End Footer -->

    </div>
    <!-- End Content -->

</div>
<!-- End Wrapper -->
<div class="clear"></div>
<script type="text/javascript">
    $(document).ready(function () {
        const data_submit = {
            func_id: 1,
            year: $("select[name='year']").val(),
            season: $("select[name='season']").val(),
            month: $("select[name='month']").val(),
            valid: 1		        // 表示精确到年(1)
        };
        console.log("Initial Data Submit:", data_submit);
        $.get("ControllerGet.php", data_submit, function (data) {
            // console.log("Data Loaded: ", data);
            paint_chart2(data_submit, data);
        }, "json").error(function () {
            alert("通讯失败");
        });
    });
    $(document).ready(function () {
        $("#submit").click(function () {
            var season = $("select[name='season']").val();
            var month = $("select[name='month']").val();
            var valid = 1;
            if(season == 0 && month == 0){
                alert("您的数据将精确到年");
                valid = 1;
            }else if(season != 0 && month == 0){
                alert("您的数据将精确到季度");
                valid = 2;
            }else if(season == 0 && month != 0){
                alert("您的数据将精确到月");
                valid = 3;
            }else{      // 判断输入是否合法
                // console.log("month != 1", (month != 1));
                if((season === "第一季" && month != 1 && month != 2 && month != 3)
                    || (season === "第二季" && month != 4 && month != 5 && month != 6)
                    || (season === "第三季" && month != 7 && month != 8 && month != 9)
                    || (season === "第四季" && month != 10 && month != 11 && month != 12)){
                    alert("您选择的季度/月份不对应,将按照月份查询");
                }else {
                    alert("您的数据将精确到月");
                }
                valid = 3;
            }
            const data_submit = {
                func_id: 1,
                year: $("select[name='year']").val(),
                season: season,
                month: month,
                valid: valid		// 表示精确到年(1)/季度(2)/月(3)
            };
            console.log("Data Submit:", data_submit);
            $.get("ControllerGet.php", data_submit, function (data) {
                console.log('success');
                console.log("Data Loaded: ", data);
                paint_chart2(data_submit, data);
            }, "json").error(function () {
                alert("通讯失败");
            });
        })
    })
</script>
</body>
</html>